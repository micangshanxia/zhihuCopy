(function(z){
var NS=function(a,b){a.Cy=b};var OS=function(a,b,c,d,f){this.Xd=a=new z.Ps(a,!f);c=new z.Us(c);d=new z.Hs(null,null,!!d,300);z.ts.call(this,a,c,d);d.Y=this;d.tl(b);(d=b.getAttribute("placeholder"))&&new z.uk(b,d)};var PS=function(a,b,c,d){var f=null;d&&(c&&(c=window.$.proxy(c,d)),f&&(f=window.$.proxy(f,d)));window.$.get("/node/"+a,{params:b},function(a){a&&a.r?f&&f(a):c&&c(a)})};var QS=function(a){z.Q.apply(this,arguments)};var RS=function(){z.G.call(this);this.ML={}};
var SS=function(a){z.Q.call(this);this.nW=a};var TS=function(a){return z.fo(a.Ge,function(a){return!!a.value})};var US=function(a){z.Gt.call(this);this.Ve="渚嬪锛氫簰鑱旂綉銆佸尰瀛︺€佹硶寰嬨€佹暟瀛�...";this.data=a||[]};
var VS=function(a){if(a.kg)(0,window.$)(a.kg).on("click",".del",window.$.proxy(function(a){var c=(0,window.$)(a.target).parents(".item");c.data("active")?(z.ef(this.Hn,c[0],0),z.Fr(c[0])):z.N(c[0]);z.A(this.data,function(a,b){a+""===c.data("url-token")+""&&this.data.splice(b,1)},this);this.Gl();this.dispatchEvent("remove")},a))};
var WS=function(a){if(a.Hn)(0,window.$)(a.Hn).on("click",".add",window.$.proxy(function(a){a=(0,window.$)(a.target).parents(".item");z.ef(this.kg,a[0],0);z.Fr(a[0]);this.Gl();this.dispatchEvent("add")},a))};var XS=function(){z.Q.call(this)};var YS=function(){z.G.call(this);this.xh="zm-item";this.yX=!0};var ZS=function(a,b){a.o().g(b,"next",a.refresh)};var $S=function(a){z.Q.apply(this,arguments)};var aT=function(){this.Mj="editing";z.Q.call(this)};
var bT=function(a,b,c){z.tm.mb&&null==window.navigator.userAgent.match(/iPad/i)||(a=(0,window.$)(".item",a.J).index(b),b.siblings().eq(a-a%2).height(c?"auto":b.height()))};var cT=function(a){z.Q.apply(this,arguments)};var dT=function(a){return window.$.post("/people/edit",{data:JSON.stringify(a)})};
var eT=function(a){var b=(0,window.$)(".js-genderItem",a.h);a.ED=(0,window.$)('[name\x3d"gender"]',b);fT(b,function(){var b=a.ED.filter(":checked").val();if(b)return dT({gender:b}).then(function(a){a&&!a.r&&(a.value="1"===b?"鐢�":"濂�");return a});z.V.alert("璇烽€夋嫨浣犵殑鎬у埆")})};
var gT=function(a){var b=(0,window.$)(".js-weiboItem",a.h);a.pN=(0,window.$)('[name\x3d"weibo-visi"]',b);fT(b,function(){var b=a.pN.filter(":checked").val();return dT({enable_weibo:b}).then(function(a){a&&!a.r&&(a.value="1"===b?"鏄�":"鍚�");return a})})};var hT=function(a){var b=(0,window.$)(".js-headlineItem",a.h);a.FD=(0,window.$)('[name\x3d"headline"]',b);fT(b,function(){var b=a.FD.val();return dT({headline:b}).then(function(a){a&&!a.r&&(a.value=b);return a})})};
var iT=function(a){var b=(0,window.$)(".js-descriptionItem",a.h);a.AD=(0,window.$)('[name\x3d"description"]',b);fT(b,function(){var b=a.AD.val();return dT({description:b}).then(function(a){a&&!a.r&&(a.value=b);return a})})};
var jT=function(a){var b=(0,window.$)(".js-orgHomepageItem",a.h);a.cN=(0,window.$)('[name\x3d"orgHomepage"]',b);fT(b,function(){var b=a.cN.val().trim();b&&!z.Ia(b,"http")&&(b="http://"+b);return dT({org_homepage:b}).then(function(a){a&&!a.r&&(a.value='\x3ca href\x3d"'+b+'" target\x3d"_blank"\x3e'+b+"\x3c/a\x3e");return a})})};
var kT=function(a){var b=(0,window.$)(".js-businessItem",a.h);a.wD=(0,window.$)('[name\x3d"business"]',b);fT(b,function(){var b=a.wD.val();return dT({business:b}).then(function(a){a&&!a.r&&(a.value=b);return a})})};var lT=function(a){var b=(0,window.$)(".js-expertItem",a.h);a.BD=(0,window.$)('[name\x3d"enable_expert"]',b);fT(b,function(){var b=a.BD.filter(":checked").val();return dT({enable_expert:b}).then(function(a){a&&!a.r&&(a.value="1"===b?"寮€鍚�":"鍏抽棴");return a})})};
var fT=function(a,b){function c(){d.toggle();f.toggle()}var d=(0,window.$)(".ProfileEditCard-staticContent",a),f=(0,window.$)(".ProfileEditCard-editableContent",a),g=(0,window.$)(".js-toggleContent",a),h=(0,window.$)(".js-save",a),k=(0,window.$)(".js-value",a);g.click(c);h.click(z.tk(h,function(){return b().then(function(b){if(b)if(b.r){var d=b.msg;z.Y.Qc&&263===b.errcode&&z.ma(d)&&(d[0][1]={headline:"Slogan 涓嶈兘瓒呰繃 40 涓瓧",description:"鏈烘瀯绠€浠嬩笉鑳借秴杩� 500 涓瓧"}[d[0][0]]);z.V.message(z.ma(d)?d[0][1]:d)}else c(),
k.html(b.value),a.toggleClass("is-empty",!b.value)})}))};var mT=function(a){var b=(0,window.$)(".js-locationTagEditor",a.h)[0];if(b){var c=a.hU=new SS;c.w(b);nT(a,c,function(){var a=(0,window.$)(".ProfileTagEditor-item",b).map(function(a,b){return(0,window.$)(b).data("title")}).get();return dT({location:a})})}};var oT=function(a){var b=(0,window.$)(".js-employmentTagEditor",a.h)[0];if(b){var c=a.uQ=new SS;c.w(b);nT(a,c,function(){var c=(0,window.$)(".ProfileTagEditor-item",b).map(a.nK).get();return dT({employment:c})})}};
var pT=function(a){var b=(0,window.$)(".js-educationTagEditor",a.h)[0];if(b){var c=a.sQ=new SS;c.w(b);nT(a,c,function(){var c=(0,window.$)(".ProfileTagEditor-item",b).map(a.nK).get();return dT({education:c})})}};
var nT=function(a,b,c){var d=b.m(),f=(0,window.$)(".ProfileEditCard-staticContent",d),g=(0,window.$)(".ProfileEditCard-editableContent",d);(0,window.$)(".js-toggleContent",d).click(function(){f.toggle();g.toggle()});a.o().g(b,["remove","dragend"],c).g(b,"add",function(){f.toggle();g.toggle();return c()})};
var qT=function(a){var b=(0,window.$)(".ProfileProgress");if(b.length){var c=new RS,d=(0,window.$)(".ProfileProgress-completeness",b);a.o().g(c,"update",function(){var a=(0,window.parseInt)(100*c.X(),10);10>a&&(a=10);a+="%";d.width(a).text(a)});[a.hU,a.uQ,a.sQ].forEach(function(a,b){c.watch({name:"tagEditor"+b,target:a,kj:["add","remove"],We:function(){return!!a.Xa.children().length}})});var f=a.ED,g=a.FD,h=a.AD,k=a.wD,l=a.BD;c.watch({name:"expert",target:l[0],kj:["change"],We:function(){return l.filter(":checked").length}}).watch({name:"expert",
target:l[1],kj:["change"],We:function(){return l.filter(":checked").length}}).watch({name:"gender",target:f[0],kj:["change"],We:function(){return f.filter(":checked").length}}).watch({name:"gender",target:f[1],kj:["change"],We:function(){return f.filter(":checked").length}}).watch({name:"description",target:h[0],kj:["blur"],We:function(){return!!h.val().trim()}}).watch({name:"business",target:k[0],kj:["blur"],We:function(){return!!k.val().trim()}}).watch({name:"headline",target:g[0],kj:["blur"],We:function(){return!!g.val().trim()}})}};
var rT=function(){z.Q.call(this)};var sT=function(a){var b=z.J("zh-profile-ask-list");if(b){var c=new z.Dl({use:["autoload","locationSource"],Uf:!1});a.L(c);c.w(b);if(a=z.L("zm-profile-section-list"))b=new YS,b.ej("zm-profile-section-item"),ZS(b,c),b.init(a)}};
var tT=function(a){var b=(0,window.$)("#zh-profile-log-list").get(0);if(b){var c=new z.Dl;c.use("locationSource",{AB:!0});a.L(c);c.w(b);z.rE(b);(0,window.$)(b).on("click",'a[name\x3d"report"]',function(a){z.X.trackEvent(a.currentTarget,{action:"Report",element:"Button"});(new z.WB({type:"activity",id:(0,window.$)(a.currentTarget).data("id")})).submit()});z.cl(c,function(a){return z.X.vb(a,{module:"LogItem"},function(){return{card:{card_type:"Content",content:{type:"Log",id:(0,window.$)(a).attr("id").replace(/logitem-/,
"")}}}})})}};var uT=function(a){var b=(0,window.$)("#zh-profile-fav-list \x3e .zh-general-list").get(0);if(b){var c=new z.Dl({use:["autoload","nodeSource"],Uf:!1});a.L(c);c.w(b)}(0,window.$)("#zh-profile-fav-list").on("click",".zm-profile-fav-edit",function(){z.Ai({category:"collection",action:"popup_edit_collection_appear",label:"people_profile_collections_edit_collection"})})};
var vT=function(a){var b=z.J("zh-profile-topic-list");if(b){var c=new z.Dl({use:["autoload","locationSource"]});a.L(c);a.o().g(c,"itemcreated",function(a){a=a.item;var b=a.getAttribute("data-tid").split("-")[1];if(z.Y.Ag===z.nh[3]){var c=new z.Yv(!0,"/topic/bio/update","bio");c.mD=!0;c.params=["tid\x3d"+b];c.bc='\x3ca href\x3d"javascript:;" name\x3d"edit"\x3e娣诲姞浣犲湪璇ヨ瘽棰樼殑缁忛獙\x3c/a\x3e';c.w(a)}});c.w(b);if(a=z.L("zm-profile-section-list"))b=new YS,b.ej("zm-profile-section-item"),ZS(b,c),b.init(a)}};
var wT=function(a){var b=(0,window.$)("#zh-profile-column-list \x3e .zh-general-list").get(0);if(b){var c=new z.Dl({use:["autoload","nodeSource"]});a.L(c);c.w(b)}};var xT=function(a){var b=(0,window.$)("#zh-profile-follows-list \x3e .zh-general-list").get(0);if(b){var c=new z.Dl({use:["autoload","nodeSource"]});a.L(c);c.w(b)}};var yT=function(a){var b=(0,window.$)("#zh-profile-follows-list-old").get(0);if(b){var c=new z.Dl({use:["autoload","locationSource"]});a.L(c);c.w(b)}};
var zT=function(a){var b=(0,window.$)("#zh-profile-answer-list \x3e .zh-general-list").get(0)||(0,window.$)("#zh-profile-answer-list").get(0);if(b){var c=new z.Dl({Uf:!1});a.L(c);c.use("childConstructor",{Hj:z.JD}).use("expandLimit");c.w(b);a.o().g(c,"click!",function(a){"comment"===a.namespace&&a.Jc.fill("category","profile").fill("label","profile_answers_list")});if(a=z.L("zm-profile-section-list"))b=new YS,ZS(b,c),b.init(a)}};
var AT=function(a){var b=z.J("zh-profile-page-force-to-rename");(a.Ty=b)&&a.o().g(b,"click",a.MY)};var BT=function(a){var b=z.J("zh-profile-activity-wrap");b&&a.o().g(b,"click",function(a){if((a=a.target)&&"focus"===a.name){var b=a.getAttribute("data-type");(0,z.QG)(a,b,null,["zm-profile-follow-link-gray","zm-profile-unfollow-link-gray"])}})};
var CT=function(a){var b=z.J("zh-profile-activity-page-list");if(b){var c=new z.Dl({use:["expandLimit"],Uf:!0});c.use("locationSource",{url:"/people/"+z.nh[1]+"/activities",hu:10,param:function(a){return{start:z.jb(a).getAttribute("data-time")}}});c.use("childConstructor",{factory:z.ZD});a.L(c);c.w(b);a.o().g(c,"click!",function(a){"comment"===a.namespace&&a.Jc.fill("category","profile").fill("label","profile_feed")})}};
var DT=function(){var a=z.L("zm-profile-header-operation");a&&(new z.WF).w(a);if(a=z.L("zm-profile-header"))(new $S).w(a),(0,window.$)(".zm-profile-header .icon-badge-wrapper").on("click",function(){(0,window.$)(".zm-profile-side-badges-section").each(function(a,c){return z.Fr(c)})})};
var ET=function(a){var b=z.L("zm-profile-answer-sort");b&&(a.ki=new z.Uz,a.ki.Ha(a.EO=new z.Pz("鎸夋椂闂存帓搴�")),a.ki.Ha(a.FO=new z.Pz("鎸夋姇绁ㄦ帓搴�")),a.ki.Ha(a.DO=new z.Pz("闂�"+z.Y[0]+"鐨勯棶棰�")),a.ki.render(b),a.ki.F(!1),a.o().g(b,"click",function(a){this.ki.F(!0);a.stopPropagation();this.o().xa(window.document,"click",function(){this.ki.F(!1)})}),a.o().g(a.ki,"action",a.tS))};
var FT=function(a,b){var c=new z.wp(!0);a.o().xa(c,"complete",function(){window.location.reload()});c.ajax("/people/"+z.nh[1]+"/block","action\x3d"+(b?"add":"cancel"))};var GT=function(){var a=(0,window.$)(".ProfileEditCard")[0];a&&(new cT).w(a)};var HT=function(a){var b=z.L("zm-profile-fav-wrap");b&&a.o().g(b,"click",a.AQ)};
var IT=function(a){var b=(0,window.$)(".zm-profile-section-wrap.column-list");b.length&&((0,window.$)(".js-expand",b).click(function(){(0,window.$)(".zm-profile-section-list",b).append((0,window.$)(".ProfileColumnItem-template").html());(0,window.$)(this).hide();return!1}),b.on("click",".item",function(a){"a"!==a.target.tagName.toLowerCase()&&window.open((0,window.$)(this).data("href"))}));var c=(0,window.$)("#zh-profile-post-list").get(0);if(c){var d=new z.Dl({Uf:!1});a.L(d);d.use("childConstructor",
{Hj:z.RD}).use("expandLimit");d.w(c);a.o().g(d,"click!",function(a){"comment"===a.namespace&&a.Jc.fill("category","profile").fill("label","profile_posts_list")})}};var JT=function(){var a=z.J("zh-profile-edit-expert");a&&(new XS).w(a)};
var KT=function(a){var b=z.L("profile-expert-tip");b&&a.o().g(b,"click",function(a){var c=a.target;"enable"!==c.name&&"close"!==c.name||window.$.post("/node/ProfileExpertTopicsV2",{method:c.name},function(a){a&&a.r||("enable"===c.name?window.location.href="/people/edit/expert":z.yr(b,!0))})});var c=(0,window.$)(".zm-profile-section-wrap.skilled-topics");c.length&&((new aT).w(c[0]),(0,window.$)(".js-expand",c).click(function(){(0,window.$)(".zm-profile-section-list",c).append((0,window.$)(".ProfileExpertItem-template").html());
(0,window.$)(this).hide();return!1}));(0,window.$)(".zm-profile-module.skilled-topics").each(function(){(new aT).w(this)});(0,window.$)(".zm-profile-module.active-topics").each(function(){(new aT).w(this)})};var LT=function(){var a=(0,window.$)(".js-ProfileBan-timer");if(a.length)var b=Number(a.html()),c=(0,window.setInterval)(function(){b--;a.html(b);0===b&&((0,window.clearInterval)(c),window.location.href="/")},1E3)};
var MT=function(){"#hilightbadge"===window.location.hash&&(0,window.$)(".zm-profile-side-badges-section").each(function(a,b){return z.Fr(b)})};z.y(OS,z.ct);OS.prototype.Wm=function(a,b){a=a[0].slice(1);a=z.lb(a,function(a){return 3<a.length});a=z.mb(a,function(a){return a[1]});this.filter&&(a=this.filter(a));OS.v.Wm.call(this,a,b)};z.n(QS,z.Q);
QS.prototype.T=function(a){z.Q.prototype.T.call(this);this.J=(0,window.$)(a);this.Fe=(0,window.$)(".info-wrap",this.J);this.ge=(0,window.$)(".edit-wrap",this.J);(0,window.$)(".title",this.Fe);this.rj=(0,window.$)("input",this.ge)};
QS.prototype.C=function(){z.Q.prototype.C.call(this);this.J.on("click",'[name\x3d"edit"]',z.Rq(window.$.proxy(function(){this.J.addClass("editing");var a=this.ge.find("input").get(0);a?a.focus():(a=this.ge.find("textarea").get(0))&&a.focus()},this),[!0,{Ie:!1}]));var a=this;this.Dr=[];(0,window.$)("input[type\x3dtext]",this.J).each(function(){var b=new OS("/topic/autocomplete",this,(0,window.$)(this).parents(".topic-input-wrap")[0]);a.Dr.push(b)});this.ge.on("keydown","input",function(a){13===a.keyCode&&
(0,window.setTimeout)(function(){var b=(0,window.$)(a.target),f=b.parents(".edit-wrap").children().index(b.parent()),g=b.parents(".edit-wrap").find("input, select").get(f+1),f=b.parents(".edit-wrap").find("input, select").get(f-1);b.val()&&(g?g.focus():f&&!(0,window.$)(f).val()&&f.focus())})});this.ge.on("click",'[name\x3d"cancel"], [name\x3d"save"]',window.$.proxy(function(a){a=a.target.name;"cancel"===a?this.cancel():"save"===a&&this.save()},this));var b=(0,window.$)(".fold-wrap");b.click(function(a){"fold"===
a.target.name?b.addClass("fold"):"unfold"===a.target.name&&b.removeClass("fold")})};
QS.prototype.save=function(){var a=this,b=this.J.data("name");if("location"===b){var b=this.ge.find("input.location"),c=this.ge.find("select"),d=this.ge.find("input.male").is(":checked")?1:0;window.$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{location:[b.val()],business:c.val(),gender:d}}},function(b){b&&b.r?z.V.message(b.msg):(b=b.msg,b.location[0].html||(b.location[0].html='\x3ca href\x3d"javascript:;" class\x3d"zg-link-litblue-normal" name\x3d"edit"\x3e濉啓灞呬綇鍦癨x3c/a\x3e'),b.business.html||
(b.business.html='\x3ca href\x3d"javascript:;" class\x3d"zg-link-litblue-normal" name\x3d"edit"\x3e濉啓琛屼笟\x3c/a\x3e'),a.Fe.find("span.location").attr("title",b.location[0].text).html(b.location[0].html),a.Fe.find("span.business").attr("title",b.business.text).html(b.business.html),b=1===(0,window.parseInt)(b.gender,10)?"male":"female",a.Fe.find("span.gender i").removeClass("icon-profile-female icon-profile-male").addClass("icon-profile-"+b),a.cancel())})}else"employment"===b?(c=this.ge.find("input.employment"),
b=this.ge.find("input.position"),c=c.val(),b=b.val(),window.$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{employment:[[c,b]]}}},function(b){b&&b.r?z.V.message(b.msg):(b=b.msg,b.employment[0][0].text||b.employment[0][1].text?a.J.removeClass("empty"):a.J.addClass("empty"),b.employment[0][0].html||(b.employment[0][0].html='\x3ca href\x3d"javascript:;" class\x3d"zg-link-litblue-normal" name\x3d"edit"\x3e濉啓鍏徃淇℃伅\x3c/a\x3e'),b.employment[0][1].html||(b.employment[0][1].html='\x3ca href\x3d"javascript:;" class\x3d"zg-link-litblue-normal" name\x3d"edit"\x3e濉啓鑱屼綅\x3c/a\x3e'),
a.Fe.find(".employment").attr("title",b.employment[0][0].text).html(b.employment[0][0].html),a.Fe.find(".position").attr("title",b.employment[0][1].text).html(b.employment[0][1].html),a.cancel())})):"education"===b?(c=[this.ge.find("input.education"),this.ge.find("input.education-extra")],b=c[0].val(),c=c[1].val(),window.$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{education:[[b,c]]}}},function(b){b&&b.r?z.V.message(b.msg):(b=b.msg,b.education[0][0].text||b.education[0][1].text?a.J.removeClass("empty"):
a.J.addClass("empty"),b.education[0][0].html||(b.education[0][0].html='\x3ca href\x3d"javascript:;" class\x3d"zg-link-litblue-normal" name\x3d"edit"\x3e濉啓瀛︽牎淇℃伅\x3c/a\x3e'),b.education[0][1].html||(b.education[0][1].html='\x3ca href\x3d"javascript:;" class\x3d"zg-link-litblue-normal" name\x3d"edit"\x3e濉啓涓撲笟\x3c/a\x3e'),a.Fe.find(".education").attr("title",b.education[0][0].text).html(b.education[0][0].html),a.Fe.find(".education-extra").attr("title",b.education[0][1].text).html(b.education[0][1].html),
a.cancel())})):"description"===b&&(b=this.ge.find("textarea.description"),window.$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{description:b.val()}}},function(b){b&&b.r?z.V.message(b.msg):(b=b.msg,b.description.text?a.J.removeClass("empty"):(b.description.fold_html='\x3ca href\x3d"javascript:;" class\x3d"zg-link-litblue-normal" name\x3d"edit"\x3e濉啓涓汉绠€浠媆x3c/a\x3e',b.description.unfold_html='\x3ca href\x3d"javascript:;" class\x3d"zg-link-litblue-normal" name\x3d"edit"\x3e濉啓涓汉绠€浠媆x3c/a\x3e',
a.J.addClass("empty")),a.Fe.find(".fold-item .content").empty().html(b.description.fold_html),a.Fe.find(".unfold-item .content").html(b.description.unfold_html),b.description.shortened?a.Fe.removeClass("disable-fold"):a.Fe.addClass("disable-fold"),a.cancel())}))};QS.prototype.cancel=function(){this.J.removeClass("editing")};z.n(RS,z.G);RS.prototype.update=function(a,b){this.ML[a]=b;this.dispatchEvent({type:"update"})};
RS.prototype.watch=function(a){function b(){return c.update(a.name,a.We())}var c=this;b();z.F(a.target,a.kj,b);return this};RS.prototype.X=function(){var a=Object.values(this.ML),b=a.filter(Boolean).length;return a.length&&b/a.length};z.y(SS,z.Q);z.e=SS.prototype;
z.e.T=function(a){SS.v.T.call(this,a);this.Ge=(0,window.$)("input",a);this.Xa=(0,window.$)(".ProfileTagEditor-list",this.h);this.Dr=[];var b=this;b.Dr=this.Ge.map(function(){var a=new OS("/topic/autocomplete",this,b.nW||(0,window.$)(this).closest(".js-inputWrapper")[0]);a.On=!1;var d=(0,z.t)(b.filter,b);a.filter=d;return a});this.Xm()};
z.e.C=function(){this.o().g(z.L("js-add",this.h),"click",this.add);var a=this;this.Ge.each(function(){a.o().g(this,"keydown",function(a){this.keydown(a)})});z.A(this.Dr,function(b){a.o().g(b.M,z.vs,a.select)});this.Xa.on("click",".js-delete",window.$.proxy(this.remove,this));this.Xm()};
z.e.Xm=function(){if(!z.tm.mb){var a=this;this.le&&this.le.dispose();var b=new z.ft;b.Fb(this);b.Js=(0,z.ab)("is-moving").split(" ");z.gt(b,this.Xa[0],0);b.init();this.le=b;(0,window.$)("a, input, button",this.Xa).each(function(){a.o().g(this,"mousedown",function(a){a.stopPropagation()})})}};z.e.keydown=function(a){13===a.keyCode&&(0,window.setTimeout)((0,z.t)(function(){TS(this)&&this.add();this.Ge[0].value&&this.Ge[1]&&!this.Ge[1].value&&this.Ge[1].focus()},this));return!0};
z.e.sq=function(){z.A(this.Ge,function(a){a.value=""});this.Ge[0].focus()};z.e.select=function(){TS(this)&&this.add()};z.e.add=function(){var a=(0,z.ab)(this.Ge[0].value),b={title:a};if(this.Ge[1]){var c=(0,z.ab)(this.Ge[1].value);if(!a&&!c)return;b.sub_title=c}PS("ProfileTagEditorItem",b,this.IU,this)};
z.e.IU=function(a){a=(0,window.$)(a);var b;if(a.data("title")){if(b=this.Xa.find("[data-title\x3d'"+a.data("title")+"']")[0]){z.Fr(b);this.sq();return}}else if(a.data("sub-title")&&(b=this.Xa.find("[data-sub-title\x3d'"+a.data("sub-title")+"']")[0])){z.Fr(b);this.sq();return}this.Xa.append(a);this.Xm();this.sq();this.dispatchEvent("add")};z.e.remove=function(a){(0,window.$)(a.target).parents("li").remove();this.dispatchEvent("remove")};
z.e.filter=function(a){return z.lb(a,function(a){return!this.Xa.find("[data-title\x3d'"+a+"']")[0]},this)};z.y(US,z.Gt);z.e=US.prototype;z.e.w=function(a){this.h=a;this.Og=z.L("zm-tag-editor-labels",this.h);this.we(!0);this.je();this.dc();this.kg=z.J("zh-expert-topics");this.Hn=z.J("zh-active-topics");VS(this);WS(this);this.data=(0,window.$)("#zh-expert-topics .item").map(function(){return(0,window.$)(this).data("url-token")}).get();this.Xm()};
z.e.Wl=function(){this.Bc||(this.Bc=z.M("div","zm-tag-editor-editor",[this.me=z.M("div","zg-section zm-tag-editor-command-buttons-wrap",[this.Za=z.J("profile-expert-edit-input")])]),this.Ve&&(this.zA=new z.rt(this.Ve),this.zA.w(this.Za),this.Za.title=this.Ve),z.df(this.Bc,this.Og),this.Gf(this.me))};
z.e.Gf=function(a){this.O=new z.Ft("/topic/autocomplete",this.Za,null,null,a,!0);this.O.Lg(!0);this.O.Ak=this.xe;this.O.bn(this.Rf());NS(this.O,[this.Ve]);this.o().g(this.O,"select",this.Nf);this.o().g(this.O,"suggestionsupdate",this.In);this.o().g(this.O,"suggestionsupdate",this.Rw);this.o().g(this.O,z.xs,function(){(0,window.$)(this.O.M.h).hide()})};z.e.Rw=function(){if(0===this.O.Na.length){var a=z.M("div",{className:"zu-autocomplete-empty"},"娌℃湁鍚嶅瓧涓� "+(0,window.$)(this.Za).val()+" 鐨勮瘽棰�");(0,window.$)(this.O.M.h).html(a).show()}};
z.e.Nf=function(){var a=this.O.sg().slice(1);a&&3<a.length&&(this.LF=a,this.Je(a))};z.e.Je=function(a){this.data.push(a[1]);var b=(0,window.$)(this.kg).find("[data-url-token\x3d'"+a[1]+"']")[0];b?z.Fr(b):(PS("TopicMediumV2",{member_url_token:z.Y[1],topic_url_token:a[1]},this.ss,this),(0,window.$)(this.Hn).find("[data-url-token\x3d'"+a[1]+"']").remove(),this.dispatchEvent("add"))};z.e.ss=function(a){a=(0,window.$)(a)[0];z.ef(this.kg,a,0);z.Fr(a);this.Gl()};z.e.Hd=function(){};
z.e.Xm=function(){if(!z.tm.mb){var a=this;this.le&&this.le.dispose();var b=new z.ft;b.Js=(0,z.ab)("expert-item-moving").split(" ");z.gt(b,this.kg,4);b.init();this.le=b;this.o().g(this.le,"dragend",function(){this.dispatchEvent("sort")});(0,window.$)("a, input, .del, .add",this.kg).each(function(){a.o().g(this,"mousedown",function(a){a.stopPropagation()})});this.o().g(this.le,"beforedragstart",function(){return z.L("editing",this.kg)?!1:!0})}};
z.e.Gl=function(){var a=(0,window.$)(this.kg).children().length;20<a&&z.N((0,window.$)(this.kg).children()[20]);z.P(z.J("zh-profile-expert-empty"),0>=a);0<a&&z.P(z.J("zh-profile-expert-warning"),!1);a=(0,window.$)(this.Hn).children().length;z.P(z.J("active-topics-wrap"),a);this.Xm()};z.e.Rf=function(){return(0,z.t)(function(a){return z.lb(a,function(a){return z.fo(this.data,function(c){return c+""!==a[2]+""&&3<a.length})},this)},this)};z.y(XS,z.Q);
XS.prototype.T=function(a){this.h=a;this.La=new US;this.La.w(this.h);this.form=z.J("zm-profile-expert-editform");this.o().g(this.form,"submit",this.Iu);this.o().g(this.La,["add","remove","sort"],function(){this.kh()});(0,window.$)(".enable").on("change","input",window.$.proxy(function(){this.kh()},this));var b=z.J("zh-profile-expert-warning");b&&this.o().g(b,"click",function(a){"close"===a.target.name&&z.yr(b)});(0,window.$)(".enable input[type\x3d'radio']").click(function(a){a=!Number((0,window.$)(a.target).val());
z.P(z.J("zh-profile-expert-reopen-tip"),a)})};XS.prototype.kh=function(){(0,window.$)(window).on("beforeunload.profile",(0,z.t)(function(){return"浣犵殑鏇存敼杩樻湭淇濆瓨锛岀‘璁ょ寮€璇ラ〉闈㈠悧锛�"},this))};XS.prototype.yi=function(){(0,window.$)(window).off("beforeunload.profile")};
XS.prototype.Iu=function(a){a.preventDefault();z.mb(this.La.data,function(a){return a[3]});a=(0,window.$)(this.form).serializeArray()[0].value;var b=(0,window.$)("#zh-expert-topics .item").map(function(){return(0,window.$)(this).data("url-token")}).get(),c=this;window.$.post("/node/ProfileEditExpertTopicsV2",{method:"save",params:{settings:{enable_expert:a,expert_topic:b}}},function(a){a&&a.r||(c.yi(),window.location.href="/people/"+z.Y[1])})};z.y(YS,z.Wj);z.e=YS.prototype;
z.e.init=function(a){this.Mb=a;this.o().g(a,"click",this.Wa);this.refresh()};z.e.ej=function(a){this.xh=a};
z.e.Wa=function(a){if(a.target){var b=z.Mr(this.Mb,a.target);b&&(this.type=b.getAttribute("data-type"),this.id=b.getAttribute("data-id"),this.action=b.name,this.item=z.Lo(a.target,this.xh),this.type&&this.id&&this.action&&this.item&&!this.SM&&(this.SM=!0,this.xhr=new z.wp(!0),this.o().g(this.xhr,"complete",this.Ik),this.xhr.ajax("/people/"+("top"===this.action?"pin":"unpin")+"_"+this.type,this.type+"_id\x3d"+this.id,"POST")))}};
z.e.Ik=function(){if("cancel-top"===this.action)z.yr(this.item,!0);else if("top"===this.action){var a=z.Uo(this.xh,this.Mb);this.Ih=z.ao(this.item).y;a&&2<=a.length&&z.cf(z.N(this.item),z.L(this.xh,this.Mb));this.scroll();z.Fr(this.item);a=z.L("zm-item-top-btn-top",this.item);z.P(a,!1);a=z.L("zm-item-top-btn-cancel",this.item);z.P(a,!0);this.refresh()}this.SM=!1};z.e.scroll=function(){if(this.yX){var a=z.L("zm-profile-section-wrap"),b=z.xf(z.Ie((z.u||window).document)).y;a&&0>z.ao(a).y-b&&a.scrollIntoView()}};
z.e.refresh=function(){var a=z.Uo(this.xh,this.Mb);a&&0<a.length&&z.A(a,function(a,c){if(0!==c){var d=z.L("zm-item-top-btn-top",a);d&&z.P(d,!0)}},this)};z.n($S,z.Q);$S.prototype.T=function(a){z.Q.prototype.T.call(this);a&&(this.J=(0,window.$)(a),(a=(0,window.$)(".ProfileAvatarEditor",this.J)[0])&&(new z.Fz).w(a),(0,window.$)(".editable-group",this.J).each(function(){(new QS).w(this)}),(a=z.J("profile-header-description-input"))&&new z.as(a))};z.y(aT,z.Q);
aT.prototype.T=function(a){aT.v.T.call(this,a);this.J=(0,window.$)(a);this.J.on("click",'a[href^\x3d"javascript"]',window.$.proxy(this.Wa,this));this.J.on("click",'a[href^\x3d"javascript"], input',!1);this.J.on("click",".item",window.$.proxy(this.XV,this))};aT.prototype.XV=function(a){var b=(0,window.$)(a.currentTarget),c=b.data("href"),b=c&&!b.hasClass(this.Mj);a=a.metaKey||a.ctrlKey;b&&(a?window.open(c):window.location.href=c)};
aT.prototype.Wa=function(a){var b=(0,window.$)(a.currentTarget),c=b.closest(".item");a=b.attr("name");if("edit"===a)b.closest(".description").hide().siblings(".description-edit").show().find("input").focus().closest(".item").addClass(this.Mj).closest(".skilled-topics").addClass(this.Mj),bT(this,c);else if("cancel"===a)b.closest(".description-edit").hide().siblings(".description").show().closest(".item").removeClass(this.Mj).closest(".skilled-topics").removeClass(this.Mj),bT(this,c,!0);else if("save"===
a){var d=new z.wp(!0);this.o().g(d,"success",function(){var a=z.Wn(d);a.r?z.V.message(a.msg):(b.closest(".description-edit").hide().siblings(".description").show().children(".des").text(a.msg).siblings(".edit").addClass("zu-edit-button").children(".edit-msg").html("淇敼").closest(".item").removeClass(this.Mj).closest(".skilled-topics").removeClass(this.Mj),bT(this,c,!0))});d.ajax("/topic/bio/update","tid\x3d"+b.closest(".item").data("id")+"\x26bio\x3d"+b.parent().siblings("input").val(),"POST")}};
z.n(cT,z.Q);cT.prototype.C=function(){z.Q.prototype.C.call(this);var a=(0,window.$)(".ProfileAvatarEditor",this.h)[0];a&&(new z.Fz).w(a);eT(this);gT(this);hT(this);iT(this);jT(this);kT(this);mT(this);oT(this);pT(this);lT(this);qT(this)};cT.prototype.nK=function(a,b){var c=(0,window.$)(b),d=c.data("title"),c=c.data("subTitle")||"";return[[d,c]]};z.y(rT,z.Q);z.e=rT.prototype;z.e.init=function(){z.TG.L(this);this.w(window.document.body)};
z.e.C=function(){rT.v.C.call(this);DT();MT();BT(this);AT(this);CT(this);HT(this);GT();ET(this);JT();KT(this);IT(this);sT(this);zT(this);tT(this);vT(this);wT(this);xT(this);yT(this);uT(this);this.ip();LT();-1<window.location.search.indexOf("clean-followers-noti\x3d1")&&(new z.wp(!0)).ajax("/notification/clear","no_refresh_content\x3dtrue\x26type\x3dfollow");(0,window.$)("#__signin").click(function(){(new z.Sk).show()});(0,window.$)(".zm-profile-header-user-edit").click(z.Rq(z.r,[!0,{Ie:!1}]))};
z.e.MY=function(){z.V.confirm("纭畾","纭畾瑕佸己鍒舵鐢ㄦ埛鏀瑰悕鍚楋紵",function(a){if(a&&(z.J("realname_form").submit(),this.Ty.innerHTML="宸插彂閫�",z.U.add(this.Ty,"zg-gray"),a=this.Ty))if(z.Vc(a))a.oe&&a.oe.removeAll(void 0);else if(a=z.ed(a)){var b=0,c;for(c in a.pc)for(var d=a.pc[c].concat(),f=0;f<d.length;++f)z.nd(d[f])&&++b}},this)};
z.e.ip=function(){if((0,window.$)(".zu-main-sidebar").length){this.pk();var a=z.J("zm-profile-header-pm-btn");a&&z.F(a,"click",z.kp(function(a){a.preventDefault()},z.Rq(function(){var b=new z.Bx({ul:!1});b.show();z.Dx(b,z.nh[3],z.nh[0]);z.Cx(b,a.href);b.Dd.focus()},!0)));var b=z.J("zh-profile-cancel-block");b&&this.o().g(b,"click",this.GJ);b=(0,window.$)("#zh-report-people, #profile-side-op a[name\x3dreport]");b.length&&(b.on("click",function(a){(new z.WB({type:"member",id:z.nh[3]})).render();z.X.trackEvent(a.currentTarget,
{action:"ReportIntent",element:"Button"})}),z.X.vb((0,window.$)(".zu-main-sidebar")[0],{module:"RightSideBar"}),z.X.vb(b[0],{module:"UserItem"},function(){return{card:{card_type:"Content",content:{type:"User",token:z.nh[1]}}}}));(0,window.$)(".zm-profile-side-badge .more-trigger").on("click",function(a){a.preventDefault();(0,window.$)(".zm-profile-side-badge .more-trigger-wrapper").hide();(0,window.$)(".zm-profile-side-badge .more-topics").removeAttr("hidden")})}};
z.e.GJ=function(){z.V.confirm("纭畾鍙栨秷灞忚斀锛�","鍙栨秷灞忚斀鍚庯紝瀵规柟灏嗗彲浠ュ叧娉ㄤ綘銆佸悜浣犲彂绉佷俊銆佽瘎璁轰綘鐨勫洖绛斻€佷娇鐢ㄣ€孈銆嶆彁鍙婁綘锛岄個璇蜂綘鍥炵瓟闂銆�",function(a){a&&FT(this,!1)},this)};z.e.zl=function(){this.o().xa(window.document,"click",function(){this.pb.F(!1)})};z.e.pk=function(){var a=z.J("profile-side-op");a&&this.o().g(a,"click",this.fk)};z.e.tS=function(a){var b="";a.target===this.EO?b="time":a.target===this.FO?b="vote":a.target===this.DO&&(b="ask");window.location.href="/people/"+z.Y[1]+"/answers?sort\x3d"+b};
z.e.fk=function(a){a=a.target.name;"block"===a?z.V.confirm("纭畾瑕佸睆钄借鐢ㄦ埛锛�","灞忚斀鐢ㄦ埛鍚庯紝瀵规柟灏嗕笉鑳藉叧娉ㄤ綘銆佸悜浣犲彂绉佷俊銆佽瘎璁轰綘鐨勫疄鍚嶅洖绛斻€佷娇鐢ㄣ€孈銆嶆彁鍙婁綘锛岄個璇蜂綘鍥炵瓟闂锛屼絾浠嶇劧鍙互鏌ョ湅浣犵殑鍏紑淇℃伅銆�",function(a){a&&FT(this,!0)},this):"cancel-block"===a&&this.GJ()};
z.e.AQ=function(a){if(a&&a.target&&(a=z.Mr(this.h,a.target))){var b=z.L("zm-profile-fav-item-title",a),c=z.L("zm-profile-fav-item-des",a);b&&c&&"fav-edit"===a.name&&(b=b.innerHTML,c=c.innerHTML||"",a=[Number(a.getAttribute("data-id")),Number(a.getAttribute("data-public")),a.getAttribute("data-url-token"),Number(a.getAttribute("data-followers-num"))],z.zA(z.uA.aa(),b,c,a))}};z.x("ZH.entryProfile",function(){(new rT).init()});z.lg("page-profile");}).call(this, __z_z__);
//# sourceURL=/static/revved/-/js/closure/page-profile.d78a74d5.js